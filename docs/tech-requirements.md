# Техническое решение

## **Кратко основная идея реализации**

В результате реализации будет доступен новый сервис, работающий для функционала TODO-листа.

## **Изменяемые микросервисы или инфраструктурные сервисы**

- Для реализации сервиса предлагается следующий стек технологий:
    - **Backend:**
        - Язык: JavaScript
        - Фреймворк: Express.js
        - БД: Mongodb которая будет удаленно работать на сервере преподавателя
        - ORM: mongoose
    - **Frontend:**
        - Технологии: Html + css статика
        - Скриптовый язык: JavaScript - статика для работы с сервером

## **Особенности деплоя**

**Деплой Backend:**
- Сначала загрузить свой backend код на удаленный сервер. Можно использовать инструменты для управления версиями кода, такие как Git.
- Убедиться, что на сервере установлен Node.js.
- Установить все зависимости, запустив npm install.
- Настроить конфигурацию приложения, включая подключение к базе данных MongoDB.
- Запустить сервер Express.js на удаленном сервере. Можно использовать инструменты типа PM2 для управления процессом.

**Деплой Frontend:**
- Скомпилировать и минифицировать HTML, CSS и JavaScript файлы, если необходимо.
- Загрузить скомпилированные файлы на удаленный сервер, где они будут обслуживаться веб-сервером.
- Убедиться, что все пути к ресурсам в коде указаны правильно.
- Проверить, что веб-сервер правильно настроен для обслуживания статических файлов.

**Общий доступ:**
- Чтобы приложение было доступно на любом устройстве с интернетом,нужно обеспечить его доступность. Для этого можно использовать облачные платформы, такие как AWS, Google Cloud, Heroku и другие.Можно использовать публичный IP-адрес или доменное имя для доступа к приложению.

## **Контракт взаимодействия с клиентами**

| Создание новой задачи |  |
| --- | --- |
| Endpoint | POST /api/tasks |
| Description | Метод для создания новой задачи |
| Request | interface Request {"title": "Название задачи","description": "Описание задачи","deadline": "Срок выполнения задачи"} |
| Response | interface Response {"success": true,"task": {"id": "уникальный идентификатор задачи","title": "Название задачи","description": "Описание задачи","deadline": "Срок выполнения задачи","created_at": "Дата создания задачи"}}; |
| Errors | • ERR_USER_NOT_AUTH - пользователь не авторизован в приложении• ERR_VALIDATION_FAILED - переданы невалидные входные параметры• ERR_FOLDER_NOT_FOUND - не найдена указанная папка |

| Получение всех задач |  |
| --- | --- |
| Endpoint | GET /api/tasks |
| Description | Метод для получения всех задач |
| Request | interface Request {//ничего} |
| Response | interface Response {"success": true,"tasks": [{"id": "уникальный идентификатор задачи","title": "Название задачи","description": "Описание задачи","deadline": "Срок выполнения задачи","created_at": "Дата создания задачи"},{"id": "уникальный идентификатор задачи","title": "Название задачи","description": "Описание задачи","deadline": "Срок выполнения задачи","created_at": "Дата создания задачи"},...]}; |
| Errors | • ERR_USER_NOT_AUTH - пользователь не авторизован в приложении• ERR_TASKS_NOT_FOUND - не найдено задач |

| Обновление задач |  |
| --- | --- |
| Endpoint | PUT /api/tasks/:taskId |
| Description | Метод для обновления задач |
| Request | interface Request {"title": "Новое название задачи","description": "Новое описание задачи","deadline": "Новый срок выполнения задачи} |
| Response | interface Response {"success": true,"message": "Задача успешно обновлена"}; |
| Errors | • ERR_USER_NOT_AUTH - пользователь не авторизован в приложении |

| Удаление задач |  |
| --- | --- |
| Endpoint | DELETE /api/tasks/:taskId |
| Description | Метод для удаления задач |
| Request | interface Request {//ничего} |
| Response | interface Response {"success": true,"message": "Задача успешно удалена"}; |
| Errors | • ERR_USER_NOT_AUTH - пользователь не авторизован в приложении |


> **Не стоит путать клиентов - с пользователями**.

**Клиент** - это frontend и все те, кто взаимодействует с сервером для получения данных и их управления.
**Сервер** - это backend и все те, кто данные обрабатывает для клиентов.
> 

## **Детальное описание ТР**

Будет создан новый сервис - `todo-service` в рамках которого реализован функционал TODO-листа.

**Backend:**

**1.Express.js Setup:**
- Создание Express приложения для обработки HTTP запросов.
- Настройка маршрутов для обработки CRUD операций над задачами.

**2.MongoDB и Mongoose:**
- Использование MongoDB для хранения данных о задачах.
- Использование Mongoose для создания модели задачи и удобного взаимодействия с базой данных.

**3.API Endpoints**:
- POST /api/tasks: Обработка запроса на создание новой задачи. Прием данных, создание новой записи в базе данных и возврат созданной задачи.
- GET /api/tasks: Обработка запроса на получение всех задач. Запрос всех задач из базы данных и возврат списка задач.
- PUT /api/tasks/:taskId: Обработка запроса на обновление задачи по идентификатору. Нахождение задачи по идентификатору, обновление данных и возврат сообщения об успешном обновлении.
- DELETE /api/tasks/:taskId: Обработка запроса на удаление задачи по идентификатору. Нахождение задачи по идентификатору, удаление задачи из базы данных и возврат сообщения об успешном удалении.

**4.Аутентификация:**
- Реализация базовой аутентификации для обеспечения безопасного доступа к функционалу сервиса.

**Frontend:**

**1.HTML, CSS и JavaScript:**
- Создание простого пользовательского интерфейса с использованием HTML для разметки, CSS для стилей и JavaScript для взаимодействия с API.

**2.Интерфейс пользователя:**
- Форма для создания новой задачи с полями для ввода заголовка, описания и срока выполнения.
- Список задач с возможностью редактирования и удаления каждой задачи.

**3.Документация API:**
- Подготовка документации API с описанием доступных методов, форматов запросов и ответов для облегчения интеграции с frontend и другими приложениями.

**Дополнительные возможности:**

**1.Обработка ошибок:**
- Реализация обработки ошибок для корректного отображения сообщений об ошибках пользователю.

**2.Реактивное обновление:**
- Возможность автоматического обновления списка задач без перезагрузки страницы для удобства пользователей.

**3.Локализация:**
- Возможность добавления поддержки различных языков для улучшения доступности сервиса для широкой аудитории.

### Авторизация

Авторизацию планируется реализовать с помощью предоставления логина и пароля пользователем на интерфейсе.

В качестве логина сервер будет ожидать email, который далее требуется подтвердить с помощью перехода по ссылке в полученном письме.

**1.Регистрация пользователя:**
- Пользователь вводит свой email и пароль на интерфейсе.
- Сервер проверяет, существует ли пользователь с таким email в базе данных.
- Если пользователь не найден, создается новая запись с email и хэшированным паролем в базе данных.

**2.Подтверждение email:**
- После успешной регистрации, на указанный email отправляется письмо с уникальной ссылкой для подтверждения.
- Пользователь переходит по ссылке в письме для подтверждения email.
- Сервер проверяет подтверждение email и активирует учетную запись пользователя.

**3.Авторизация пользователя:**
- При попытке входа, пользователь вводит email и пароль.
- Сервер проверяет соответствие введенного пароля хэшированному паролю в базе данных для указанного email.
- Если пароль верен, пользователь получает JWT (JSON Web Token) в качестве аутентификационного токена.

**4.Использование JWT:**
- Полученный JWT сохраняется на клиентской стороне (например, в localStorage).
- При каждом запросе к защищенным ресурсам, клиент отправляет JWT в заголовке запроса для аутентификации.
- Сервер проверяет валидность JWT, и в случае успеха предоставляет доступ к защищенным ресурсам.

**5.Выход из системы:**
- При выходе из системы, JWT удаляется из клиентской стороны.
- При следующем входе пользователь должен будет повторно аутентифицироваться.

### Папки

**Папка** - представляет собой список для задач.

**Backend:**

**1.Модель Папки:**
- Создание модели папки в базе данных MongoDB с уникальным идентификатором, названием и связью с задачами.

**2.API Endpoints для Папок:**
- POST /api/folders: Обработка запроса на создание новой папки. Создание новой записи папки в базе данных и возврат созданной папки.
- GET /api/folders: Обработка запроса на получение всех папок. Запрос всех папок из базы данных и возврат списка папок.
- GET /api/folders/:folderId/tasks: Обработка запроса на получение всех задач в определенной папке. Поиск папки по идентификатору, запрос всех связанных задач и возврат списка задач.
- PUT /api/folders/:folderId: Обработка запроса на обновление информации о папке. Нахождение папки по идентификатору, обновление данных папки и возврат сообщения об успешном обновлении.
- DELETE /api/folders/:folderId: Обработка запроса на удаление папки. Нахождение папки по идентификатору, удаление папки из базы данных и возврат сообщения об успешном удалении.

**Frontend:**

**1.Интерфейс для Управления Папками:**
- Добавление возможности создания новых папок с указанием названия.
- Отображение списка папок с возможностью выбора папки для просмотра задач внутри нее.

**2.Интеграция с Задачами:**
- Возможность привязывать задачи к определенным папкам для удобства организации.

**3.Дополнительные Функции:**
- Поддержка переименования папок, удаления папок и других операций с папками для удобного управления списком задач.

**Дополнительные возможности:**

**1.Рекурсивные Папки:**
- Возможность создания иерархии папок для более глубокой организации задач.

**2.Цветовая Маркировка:**
- Добавление возможности установки цветовой маркировки для папок для визуального различия.

**3.Поиск и Фильтрация:**
- Реализация поиска и фильтрации задач по папкам для быстрого доступа к нужным задачам.

### Представление задач

**Задача** - сущность, создаваемая пользователем.

**Backend:**

**1.Модель Задачи:**
- Создание модели задачи в базе данных MongoDB с уникальным идентификатором, названием, описанием, статусом (выполнена/не выполнена), сроком выполнения и связью с папкой.

**2.API Endpoints для Задач:**
- POST /api/tasks: Обработка запроса на создание новой задачи. Создание новой записи задачи в базе данных и возврат созданной задачи.
- GET /api/tasks: Обработка запроса на получение всех задач. Запрос всех задач из базы данных и возврат списка задач.
- PUT /api/tasks/:taskId: Обработка запроса на обновление информации о задаче. Нахождение задачи по идентификатору, обновление данных задачи и возврат сообщения об успешном обновлении.
- DELETE /api/tasks/:taskId: Обработка запроса на удаление задачи. Нахождение задачи по идентификатору, удаление задачи из базы данных и возврат сообщения об успешном удалении.

**Frontend:**

**1.Интерфейс для Управления Задачами:**
- Добавление возможности создания новых задач с указанием названия, описания, срока выполнения и привязки к папке.
- Отображение списка задач с возможностью фильтрации по статусу (выполнена/не выполнена) и поиска.

**2.Интеграция с Папками:**
- Возможность просмотра задач внутри определенной папки и управление задачами в контексте папки.

**3.Дополнительные Функции:**
- Поддержка отметки задачи как выполненной, изменение срока выполнения, редактирование описания и других операций с задачами.

**Дополнительные возможности:**

**1.Уведомления и Напоминания:**
- Реализация уведомлений и напоминаний о задачах для помощи пользователям не забывать о них.

**2.Приоритеты и Метки:**
- Добавление возможности установки приоритетов и меток для задач для более удобной сортировки и организации.

**3.История Изменений:**
- Ведение истории изменений задач для возможности просмотра и восстановления предыдущих версий.

